"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var Bar=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"init",value:function init(a){if(ccm.viewsCookie=new CcmCookie("Cookie_view"),ccm.viewsCookie.expires=new Date,ccm.viewsCookie.expires.setTime(ccm.viewsCookie.expires.getTime()+15552000000),ccm.viewsCookie.isSet?2<=parseInt(ccm.viewsCookie.value,10)?(CcmLog.info("More then 2 pageviews with a cookie bar visible, giving auto consent"),ccm.viewsCookie["delete"](),ccm.dispatchEvent("CCM_auto_consent"),ccm.giveConsent()):(CcmLog.info("Cookie bar counter found, incrementing the cookie bar view counter"),ccm.viewsCookie.value=parseInt(ccm.viewsCookie.value,10)+1,ccm.viewsCookie.store()):(CcmLog.info("No cookie bar counter found, creating a new one"),ccm.viewsCookie.value=1,ccm.viewsCookie.store()),ccm.cookieMessage.html)ccm.cookieMessage.show(a);else{var b=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("GET",ccmWrapper.config.assetsBaseUrl+"/sites/"+ccmWrapper.config.organisation+"/"+ccmWrapper.config.site+"/ccm-bar-nl.html?version="+ccmWrapper.version+"-"+ccmWrapper.contentId,!0),b.timeout=ccmWrapper.config.XMLHttpRequestTimeout,b.onreadystatechange=function(){if(CcmLog.debug("XHR ready state changed",b),4==b.readyState)if(200==b.status)ccm.cookieMessage.html=b.responseText,ccm.cookieMessage.show(a);else throw CcmLog.error("Received HTTP status code "+b.status+" on requesting CCM lower bar HTML",b),"exit"},b.onerror=function(a){throw CcmLog.error("Error on requesting CCM lower bar HTML",a),"exit"},b.ontimeout=function(a){throw CcmLog.error("Timeout on requesting CCM lower bar HTML",a),"exit"},b.send()}}},{key:"show",value:function show(){var a=document.createElement("div");a.setAttribute("id","ccm_notification_host");var b=a.attachShadow({mode:"open"});b.innerHTML=ccm.cookieMessage.html,b.insertBefore(ccmWrapper.createStyle(ccmWrapper.config.assetsBaseUrl+"/sites/"+ccmWrapper.config.organisation+"/"+ccmWrapper.config.site+"/ccm-bar.css?version=3.2.5"),b.firstChild);try{b.querySelector("#ccm_notification #ccm_close").addEventListener("click",ccm.cookieMessage.dismissCCM),b.querySelectorAll("#ccm_notification .ccm_toggle_extended--open").forEach(function(a){a.addEventListener("click",function(a){return a.preventDefault(),ccm.cookieMessage.toggleExtended("open"),ccm.dispatchEvent("CCM_show_more_info",{target:a.target}),!1})}),b.querySelectorAll("#ccm_notification .ccm_toggle_extended--close").forEach(function(a){a.addEventListener("click",function(a){return a.preventDefault(),ccm.cookieMessage.toggleExtended("close"),ccm.dispatchEvent("CCM_hide_more_info",{target:a.target}),!1})}),b.querySelectorAll("a.ccm_settings_link, a.npo_cc_settings_link").forEach(function(a){a.href=ccmWrapper.config.ccmSettingsBaseUrl+"/sites/"+ccmWrapper.config.organisation+"/"+ccmWrapper.config.site+"/settings.html?version="+encodeURIComponent(ccmWrapper.version+"-"+ccmWrapper.contentId)+"&referrer="+encodeURIComponent(window.location.href),a.addEventListener("click",function(a){ccm.dispatchEvent("CCM_show_settings_page",{target:a.target})})});var c=document.createElement("a"),d=document.createTextNode("Naar cookieinstellingen");c.appendChild(d),c.title="Naar cookieinstellingen",c.className="ccm_skip",c.style.position="absolute",c.style.visibility="hidden",c.style.opacity="0",c.style.width="1px",c.style.height="1px",c.href="#ccm_notification",document.body.prepend(c),document.body.appendChild(a),ccm.dispatchEvent("CCM_CookieMessage_done")}catch(a){CcmLog.error(a)}ccm.showSettingsLink()}},{key:"hide",value:function hide(){document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification").remove(),delete ccm.cookieMessage}},{key:"dismissCCM",value:function dismissCCM(a){CcmLog.debug("Dismissed CCM"),ccm.dispatchEvent("CCM_consent_dismiss",{target:a.target}),ccm.cookieMessage.giveConsent(a)}},{key:"giveConsent",value:function giveConsent(a,b){ccm.giveConsent()&&(!0===b?location.reload():ccm.cookieMessage.hide())}},{key:"toggleExtended",value:function toggleExtended(a){"open"===a?(document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification #ccm_close").classList.add("ccm_hidden_content"),document.querySelector("#ccm_notification_host").shadowRoot.querySelectorAll("#ccm_notification .ccm_toggle_extended--open").forEach(function(a){a.style.display="none"}),document.querySelector("#ccm_notification_host").shadowRoot.querySelectorAll("#ccm_notification .ccm_toggle_extended--close").forEach(function(a){a.style.display="inline-block"}),document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification #ccm_col_content_extended").classList.add("ccm_col_content_extended--open"),document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification").classList.add("ccm_notification_more_info")):(document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification #ccm_close").classList.remove("ccm_hidden_content"),document.querySelector("#ccm_notification_host").shadowRoot.querySelectorAll("#ccm_notification .ccm_toggle_extended--open").forEach(function(a){a.style.display="inline-block"}),document.querySelector("#ccm_notification_host").shadowRoot.querySelectorAll("#ccm_notification .ccm_toggle_extended--close").forEach(function(a){a.style.display="none"}),document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification #ccm_col_content_extended").classList.remove("ccm_col_content_extended--open"),document.querySelector("#ccm_notification_host").shadowRoot.querySelector("#ccm_notification").classList.remove("ccm_notification_more_info"))}},{key:"hightlightCategory",value:function hightlightCategory(){}}]),a}();Array.from||(Array.from=function(){var a=Object.prototype.toString,b=function(b){return"function"==typeof b||"[object Function]"===a.call(b)},c=function(a){var b=+a;return isNaN(b)?0:0!=b&&isFinite(b)?(0<b?1:-1)*Math.floor(Math.abs(b)):b},d=Math.pow(2,53)-1,e=function(a){var b=c(a);return Math.min(Math.max(b,0),d)};return function(a){var c=this,d=Object(a);if(null==a)throw new TypeError("Array.from requires an array-like object - not null or undefined");var f,g=1<arguments.length?arguments[1]:void 0;if("undefined"!=typeof g){if(!b(g))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(f=arguments[2])}for(var h,i=e(d.length),j=b(c)?Object(new c(i)):Array(i),l=0;l<i;)h=d[l],j[l]=g?"undefined"==typeof f?g(h,l):g.call(f,h,l):h,l+=1;return j.length=i,j}}());var CcmLog=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"log",value:function log(a){var b=!0;if("undefined"!=typeof ccmWrapper.config.log.log&&(b=ccmWrapper.config.log.log),b)try{for(var c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];if(0<d.length){var f;(f=console).log.apply(f,[a].concat(d))}else console.log(a)}catch(a){}}},{key:"info",value:function info(b){var c=!0;if("undefined"!=typeof ccmWrapper.config.log.info&&(c=ccmWrapper.config.log.info),c){for(var d=arguments.length,f=Array(1<d?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];try{if(0<f.length){var h;(h=console).info.apply(h,[b].concat(f))}else console.info(b)}catch(c){a.error(c),a.log.apply(a,[b].concat(f))}}}},{key:"debug",value:function debug(b){var c=!0;if("undefined"!=typeof ccmWrapper.config.log.debug&&(c=ccmWrapper.config.log.debug),c){for(var d=arguments.length,f=Array(1<d?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];try{if(0<f.length){var h;(h=console).debug.apply(h,[b].concat(f))}else console.debug(b)}catch(c){a.error(c),a.log.apply(a,[b].concat(f))}}}},{key:"warning",value:function warning(b){var c=!0;if("undefined"!=typeof ccmWrapper.config.log.warning&&(c=ccmWrapper.config.log.warning),c){for(var d=arguments.length,f=Array(1<d?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];try{if(0<f.length){var h;(h=console).warn.apply(h,[b].concat(f))}else console.warn(b)}catch(c){a.error(c),a.log.apply(a,[b].concat(f))}}}},{key:"error",value:function error(b){var c=!0;if("undefined"!=typeof ccmWrapper.config.log.error&&(c=ccmWrapper.config.log.error),c){for(var d=arguments.length,f=Array(1<d?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];try{if(0<f.length){var h;(h=console).error.apply(h,[b].concat(f))}else console.error(b)}catch(c){a.error(c),a.log.apply(a,[b].concat(f))}}}}]),a}(),CcmNPOATAnalytics=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"init",value:function init(a){if("undefined"!=typeof ATInternet)try{ccm.analytics.level2=ATInternet.Tracker.instances[0].getContext("page").level2,ccm.analytics.tag=new ATInternet.Tracker.Tag,window.addEventListener("CCM_cid_consent_revoked",function(){ccm.analytics.send(!1,"[cid gewijzigde toestemming ingetrokken]")},!1),window.addEventListener("CCM_show_cookie_message",function(){ccm.analytics.send(!1,"[geen toestemming toon cookie bericht]")},!1),window.addEventListener("CCM_show_settings_page",function(a){ccm.analytics.send(a.detail.target,"[pagina met instellingen weergeven")},!1),window.addEventListener("CCM_reopen_cookie_message",function(a){ccm.analytics.send(a.detail.target,"[open cookie bericht opnieuw ]")},!1),window.addEventListener("CCM_reopen_cookie_message_with_highlighting",function(a){a.detail.categories.forEach(function(b){ccm.analytics.send(a.detail.target,"[open cookie bericht opnieuw met markering]","["+b+"]")})},!1),window.addEventListener("CCM_reconsent_stored",function(){Object.entries(ccm.categoryCookies).forEach(function(a){var b=a[0];a=a[1];var c;c="true"==a.value?"geaccepteerd ":"geweigerd",ccm.analytics.send(!1,"[reconsent opgeslagen]","["+b+"]","["+c+"]","[placeholderchange]")})},!1),window.addEventListener("CCM_consent_stored",function(){Object.entries(ccm.categoryCookies).forEach(function(a){var b=a[0];a=a[1];var c;c="true"==a.value?"geaccepteerd":"geweigerd",ccm.analytics.send(!1,"[consent opgeslagen]","["+b+"]","["+c+"]","[change]","[individuele configuratie]")})},!1),window.addEventListener("CCM_show_more_info",function(a){ccm.analytics.send(a.detail.target,"[toon meer info]")},!1),window.addEventListener("CCM_hide_more_info",function(a){ccm.analytics.send(a.detail.target,"[verberg meer info]")},!1),window.addEventListener("CCM_consent_accept_all",function(){ccm.analytics.send(!1,"[consent accepteer allemaal]","","","","[accepteer alles]")},!1),window.addEventListener("CCM_consent_decline_all",function(){ccm.analytics.send(!1,"[consent afwijzen allemaal]")},!1),window.addEventListener("CCM_consent_dismiss",function(){ccm.analytics.send(!1,"[cookie melding gesloten]")},!1),window.addEventListener("CCM_auto_consent",function(){ccm.analytics.send(!1,"[consent automatisch]")},!1),window.addEventListener("CCM_provide_consent_preference",function(a){var b;b="true"==a.detail.new_value?"geaccepteerd":"geweigerd",ccm.analytics.send(a.detail.target,"[consent voorkeur opgeven]","["+a.detail.category+"]","["+b+"]")},!1),window.addEventListener("CCM_consent_revoked_by_consent_preference_change",function(a){ccm.analytics.send(a.detail.target,"[toestemming ingetrokken door toestemming voorkeurwijziging]")},!1),window.addEventListener("CCM_prebar_preferences",function(a){ccm.analytics.send(a.detail.target,"[prebar geeft voorkeuren]")},!1),window.addEventListener("CCM_back_to_prebar",function(a){ccm.analytics.send(a.detail.target,"[terug naar prebar]")},!1)}catch(a){CcmLog.error(a)}else{var b=50;ccm.analytics.ATAnalyticsReadyAttempt||(ccm.analytics.ATAnalyticsReadyAttempt=0),++ccm.analytics.ATAnalyticsReadyAttempt,4<ccm.analytics.ATAnalyticsReadyAttempt&&(b=200),20>ccm.analytics.ATAnalyticsReadyAttempt?(CcmLog.info("AT Analytics is not loaded yet. This was attempt: "+ccm.analytics.ATAnalyticsReadyAttempt+". Setting timeout for the next attempt to: "+b+"ms"),setTimeout(ccm.analytics.init,b,a)):CcmLog.error("AT Analytics was not done loading after "+ccm.analytics.ATAnalyticsReadyAttempt+" attempts. Stop waiting for Analytics.")}}},{key:"send",value:function send(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"",f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"";try{a||(a=this),ccm.analytics.tag.publisher.send({elem:a,click:{campaignId:encodeURIComponent("[ccm]"),creation:encodeURIComponent(b),variant:encodeURIComponent(c),format:encodeURIComponent(d),generalPlacement:encodeURIComponent("["+ccm.analytics.level2+"]"),detailedPlacement:encodeURIComponent("[CCM "+ccmWrapper.version+"]"),advertiserId:encodeURIComponent(e),url:encodeURIComponent(f)}})}catch(a){CcmLog.error(a)}}}]),a}(),CcmCookie=function(){function a(b){_classCallCheck(this,a),this.isSet=!1,this.name=b,this.value=null,this.domain=ccmWrapper.config.cookieDomain,this.path=ccmWrapper.config.cookiePath,this.sameSite="lax",this.expires=new Date,this.expires.setTime(this.expires.getTime()+31536000000),this.read()}return _createClass(a,[{key:"read",value:function read(){var a=document.cookie.match("(^|;) ?"+this.name+"=([^;]*)(;|$)");a&&(this.value=a[2],this.isSet=!0,CcmLog.debug("Loaded cookie: "+this.name,this,document.cookie))}},{key:"store",value:function store(){var a=[this.name+"="+this.value,"expires="+this.expires.toUTCString(),"sameSite="+this.sameSite];this.domain&&a.push("domain="+this.domain),this.path&&a.push("path="+this.path),document.cookie=a.join(";"),this.isSet?CcmLog.debug("Stored cookie: "+this.name,this,document.cookie):CcmLog.debug("Created cookie: "+this.name,this,document.cookie),this.isSet=!0}},{key:"delete",value:function _delete(){this.isSet&&(this.value=null,this.expires=new Date(0),this.store(),this.isSet=!1,CcmLog.debug("Deleted cookie: "+this.name,document.cookie))}},{key:"setExpireTime",value:function setExpireTime(a){this.expires=new Date,this.expires.setTime(this.expires.getTime()+3600000*a)}}]),a}();Object.entries||(Object.entries=function(a){for(var b=Object.keys(a),c=b.length,d=Array(c);c--;)d[c]=[b[c],a[b[c]]];return d}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a){'use strict';if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b,c=Object(a),d=1;d<arguments.length;d++)if(b=arguments[d],null!=b)for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[e]=b[e]);return c},writable:!0,configurable:!0}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)});var ccm,CcmCore=function(){function a(){_classCallCheck(this,a),this.config={log:{log:!1,info:!1,debug:!1,warning:!1,error:!1},organisation:"NOS",site:"nos.nl",cookieDomain:"nos.nl",cookiePath:"/",cookieCategories:"{\"necessary\":{\"name\":\"Functioneel\",\"defaultConsent\":\"true\",\"required\":1,\"requireConsent\":0,\"displayOption\":0,\"primary\":true,\"activateClass\":\"npo_cc_necessary\",\"inlineClass\":\"npo_cc_inline_necessary\",\"placeholderClass\":\"npo_cc_placeholder_necessary\"},\"analytics\":{\"name\":\"Analytics\",\"defaultConsent\":\"true\",\"required\":1,\"requireConsent\":0,\"displayOption\":0,\"primary\":true,\"activateClass\":\"npo_cc_analytics\",\"inlineClass\":\"npo_cc_inline_analytics\",\"placeholderClass\":\"npo_cc_placeholder_analytics\"}}",cookieMessageType:"npo_no_category_lower_bar",analyticsType:"CcmNPOATAnalytics",ccmConsentCookieName:"cookie_consent_date",ccmCookieIdCookieName:"CCM_ID",executed:!1,state:"loaded"},this.config.cookieCategories=JSON.parse(this.config.cookieCategories),this.categoryCookies=[],this.dispatchEvent("CCM_loaded")}return _createClass(a,[{key:"preprocess",value:function preprocess(){ccm.config.state="ready",ccm.dispatchEvent("CCM_ready")}},{key:"init",value:function init(a){if(ccm.config.executed)return!1;if(ccm.config.executed=!0,CcmLog.info("Running init()"),a&&(CcmLog.debug("Init contains an overruling config",a),ccm.config=Object.assign(ccm.config,a),CcmLog.debug("New CCM config",ccm.config)),ccm.config.analyticsType&&(CcmLog.info("Loading analytics: "+ccm.config.analyticsType),ccm.loadAnalytics()),ccm.consentCookie=new CcmCookie("Cookie_Consent"),ccm.consentCookie.expires=new Date,ccm.consentCookie.expires.setTime(ccm.consentCookie.expires.getTime()+15552000000),ccm.consentCookie.isSet||(ccm.consentCookie.value="false",ccm.consentCookie.store()),ccm.idCookie=new CcmCookie(ccm.config.ccmCookieIdCookieName),ccm.idCookie.expires=new Date,ccm.idCookie.expires.setTime(ccm.idCookie.expires.getTime()+315360000000),ccm.idCookie.isSet?(CcmLog.info("Checking the cookie ID."),ccm.idCookie.value!==ccmWrapper.cookieId&&(CcmLog.debug("Detected that a new cookie ID.",ccm.idCookie.value,ccmWrapper.cookieId),ccm.hasAnswered()&&(CcmLog.info("Cookie ID has changed, revoking consent."),ccm.dispatchEvent("CCM_cid_consent_revoked"),ccm.consentCookie.value="false",ccm.consentCookie.store()),ccm.idCookie.value=ccmWrapper.cookieId,ccm.idCookie.store())):(ccm.idCookie.value=ccmWrapper.cookieId,ccm.idCookie.store(),ccm.hasAnswered()&&(CcmLog.info("Cookie ID was lost, revoking consent."),ccm.consentCookie.value="false",ccm.consentCookie.store())),Object.keys(ccm.config.cookieCategories).forEach(function(a){ccm.categoryCookies[a]=new CcmCookie("Cookie_Category_"+a.charAt(0).toUpperCase()+a.slice(1)),ccm.categoryCookies[a].expires=new Date,ccm.categoryCookies[a].expires.setTime(ccm.categoryCookies[a].expires.getTime()+315360000000),ccm.categoryCookies[a].isSet?("true"!==ccm.categoryCookies[a].value&&"false"!==ccm.categoryCookies[a].value&&""!==ccm.categoryCookies[a].value&&(CcmLog.warning("Not accepted value found in "+a+" cookie value. Resetting its value!",ccm.categoryCookies[a]),ccm.categoryCookies[a].value=null==ccm.config.cookieCategories[a].defaultConsent?"":ccm.config.cookieCategories[a].defaultConsent,ccm.categoryCookies[a].store()),ccm.hasAnswered()&&ccm.config.cookieCategories[a].required&&""==ccm.categoryCookies[a].value&&(CcmLog.info(a+" is a required cookie category but has no value, revoking the users consent."),ccm.consentCookie.value="false",ccm.consentCookie.store())):(ccm.categoryCookies[a].value=null==ccm.config.cookieCategories[a].defaultConsent?"":ccm.config.cookieCategories[a].defaultConsent,ccm.categoryCookies[a].store(),ccm.hasAnswered()&&ccm.config.cookieCategories[a].required&&(CcmLog.info(a+" is a required cookie category but has no value, revoking the users consent."),ccm.consentCookie.value="false",ccm.consentCookie.store()))}),window.location.hash)switch(CcmLog.info("Possible debug URL detected"),window.location.hash.substring(1)){case"ccm-reset":CcmLog.debug("Resetting cookies"),ccm.reset(),window.location.href.substr(0,window.location.href.indexOf("#"));break;case"ccm-accept-all":CcmLog.debug("Accepting all"),ccm.massUpdateOptionalCategories("true"),ccm.giveConsent();break;case"ccm-decline-all":CcmLog.debug("Declining all"),ccm.massUpdateOptionalCategories("false"),ccm.giveConsent();}if(ccm.debugCookie=new CcmCookie("CCM_DEBUG"),ccm.debugCookie.isSet)switch(CcmLog.info("Debug cookie detected"),ccm.debugCookie.value){case"ccm-reset":CcmLog.debug("Resetting cookies"),ccm.reset(),ccm.debugCookie["delete"]();break;case"ccm-accept-all":CcmLog.debug("Accepting all"),ccm.massUpdateOptionalCategories("true"),ccm.giveConsent();break;case"ccm-decline-all":CcmLog.debug("Declining all"),ccm.massUpdateOptionalCategories("false"),ccm.giveConsent();}("false"===ccm.consentCookie.value||""===ccm.consentCookie.value)&&(setTimeout(ccm.showCookieMessage,2000),ccm.dispatchEvent("CCM_show_cookie_message")),ccm.evaluateDom(),ccm.config.state="done",ccm.dispatchEvent("CCM_done")}},{key:"evaluateDom",value:function evaluateDom(){CcmLog.info("Evaluating DOM contents"),ccm.showSettingsLink(),ccm.showCookieMessageLink(),ccm.showHightlightedCategoryLink(),ccm.showSplitRequestCategoryLink(),Object.entries(ccm.categoryCookies).forEach(function(a){var b=a[0];a=a[1],ccm.config.cookieCategories[b].requireConsent&&!ccm.hasAnswered()||"false"===a.value||""===a.value||(ccm.removePlaceholders(ccm.config.cookieCategories[b].placeholderClass),ccm.runScripts(ccm.config.cookieCategories[b].activateClass),ccm.runScripts(ccm.config.cookieCategories[b].inlineClass),ccm.runIframes(ccm.config.cookieCategories[b].activateClass),ccm.runImg(ccm.config.cookieCategories[b].activateClass),ccm.runEmbed(ccm.config.cookieCategories[b].activateClass),ccm.rubObject(ccm.config.cookieCategories[b].activateClass))})}},{key:"reset",value:function reset(){ccmWrapper.WrapperCacheCookie instanceof CcmCookie&&ccmWrapper.WrapperCacheCookie["delete"](),ccm.consentCookie instanceof CcmCookie||(ccm.consentCookie=new CcmCookie("Cookie_Consent")),ccm.consentCookie.isSet&&ccm.consentCookie["delete"](),ccm.idCookie instanceof CcmCookie||(ccm.idCookie=new CcmCookie(ccm.config.ccmCookieIdCookieName)),ccm.idCookie.isSet&&ccm.idCookie["delete"](),Object.keys(ccm.config.cookieCategories).forEach(function(a){ccm.categoryCookies[a]instanceof CcmCookie||(ccm.categoryCookies[a]=new CcmCookie("Cookie_Category_"+a.charAt(0).toUpperCase()+a.slice(1))),ccm.categoryCookies[a].isSet&&ccm.categoryCookies[a]["delete"]()})}},{key:"getCategoryConsent",value:function getCategoryConsent(a){return"object"==_typeof(ccm.categoryCookies[a])?ccm.config.cookieCategories[a].requireConsent&&!ccm.hasAnswered()?null:"true"===ccm.categoryCookies[a].value:void 0}},{key:"hasAnswered",value:function hasAnswered(){return"false"!=ccm.consentCookie.value&&""!=ccm.consentCookie.value}},{key:"getPermissions",value:function getPermissions(){var a={};return Object.entries(ccm.categoryCookies).forEach(function(b){var c=b[0];b=b[1],ccm.config.cookieCategories[c].requireConsent&&!ccm.hasAnswered()?a[c]=null:"true"===b.value?a[c]=!0:"false"===b.value?a[c]=!1:""===b.value&&(a[c]=null)}),a}},{key:"get_permissions",value:function get_permissions(){var a=[];return Object.entries(ccm.categoryCookies).forEach(function(b){var c=b[0];b=b[1],ccm.config.cookieCategories[c].requireConsent&&!ccm.hasAnswered()||"true"===b.value&&a.push(c)}),a}},{key:"has_banner",value:function has_banner(){return!!ccm.cookieMessage}},{key:"on_consent",value:function on_consent(a,b){ccm.getCategoryConsent(a)&&(ccm.is_function(b)?b():(b=function func(){},b()))}},{key:"on_no_consent",value:function on_no_consent(a,b){ccm.getCategoryConsent(a)||(ccm.is_function(b)?b():(b=function func(){},b()))}},{key:"isDone",value:function isDone(){return"done"===ccm.config.state}},{key:"is_function",value:function is_function(a){return a&&"[object Function]"=={}.toString.call(a)}},{key:"loadAnalytics",value:function loadAnalytics(a){if(ccm.analytics)return CcmLog.debug("Cant load analytics. Analytic class is already loaded."),!1;switch(ccm.config.analyticsType){case"CcmNPOATAnalytics":ccm.analytics=new CcmNPOATAnalytics,ccm.analytics.init(a);break;default:}}},{key:"showCookieMessage",value:function showCookieMessage(a){return ccm.cookieMessage?(CcmLog.debug("Cant show Cookie Message. Cookie Message is already loaded."),!1):void(ccm.cookieMessage=new Bar,ccm.cookieMessage.init(a))}},{key:"showSettingsLink",value:function showSettingsLink(){var a=document.querySelectorAll("a.ccm_settings_link, a.npo_cc_settings_link");a.forEach(function(a){a.href=ccmWrapper.config.ccmSettingsBaseUrl+"/sites/"+ccmWrapper.config.organisation+"/"+ccmWrapper.config.site+"/settings.html?version="+encodeURIComponent(ccmWrapper.version+"-"+ccmWrapper.contentId)+"&referrer="+encodeURIComponent(window.location.href),a.addEventListener("click",function(a){ccm.dispatchEvent("CCM_show_settings_page",{target:a.target})})})}},{key:"showCookieMessageLink",value:function showCookieMessageLink(){var a=document.querySelectorAll("a.ccm_message_link");a.forEach(function(a){a.href="#",a.addEventListener("click",function(a){return a.preventDefault(),ccm.showCookieMessage(),ccm.dispatchEvent("CCM_reopen_cookie_message",{target:a.target}),!1})})}},{key:"showHightlightedCategoryLink",value:function showHightlightedCategoryLink(){var a=document.querySelectorAll("a.ccm_message_highlight_link");a.forEach(function(a){a.href="#",a.addEventListener("click",function(a){return a.preventDefault(),ccm.cookieMessage?a.target.dataset.ccmCategories.split(",").forEach(function(b){"object"==_typeof(ccm.categoryCookies[b])?ccm.cookieMessage.hightlightCategory(b):CcmLog.warning("Category "+b+" does not exist!",a.target)}):(window.addEventListener("CCM_CookieMessage_done",function(){a.target.dataset.ccmCategories.split(",").forEach(function(b){"object"==_typeof(ccm.categoryCookies[b])?ccm.cookieMessage.hightlightCategory(b):CcmLog.warning("Category "+b+" does not exist!",a.target)})},!1),ccm.showCookieMessage({skipPreBar:!0})),ccm.dispatchEvent("CCM_reopen_cookie_message_with_highlighting",{target:a.target,categories:a.target.dataset.ccmCategories.split(",")}),!1})})}},{key:"showSplitRequestCategoryLink",value:function showSplitRequestCategoryLink(){var a=document.querySelectorAll("a.ccm_message_split_request_link");a.forEach(function(a){a.href="#",a.addEventListener("click",function(a){return a.preventDefault(),ccm.cookieMessage?a.target.dataset.ccmCategories.split(",").forEach(function(b){"object"==_typeof(ccm.categoryCookies[b])?ccm.cookieMessage.splitRequestCategory(b):CcmLog.warning("Category "+b+" does not exist!",a.target)}):(window.addEventListener("CCM_CookieMessage_done",function(){a.target.dataset.ccmCategories.split(",").forEach(function(b){"object"==_typeof(ccm.categoryCookies[b])?ccm.cookieMessage.splitRequestCategory(b):CcmLog.warning("Category "+b+" does not exist!",a.target)})},!1),ccm.showCookieMessage({skipPreBar:!0})),ccm.dispatchEvent("CCM_reopen_cookie_message_with_split_request",{target:a.target,categories:a.target.dataset.ccmCategories.split(",")}),!1})})}},{key:"removePlaceholders",value:function removePlaceholders(a){var b=document.querySelectorAll("."+a);b.forEach(function(a){a.parentNode.removeChild(a)})}},{key:"runScripts",value:function runScripts(a){var b=document.querySelectorAll("script[type=\"text/plain\"]."+a);b.forEach(function(a){var b=document.createElement("script");b.type="text/javascript",a.getAttribute("data-src")&&(b.src=a.getAttribute("data-src")),b.text=a.textContent,document.head.appendChild(b),a.parentNode.removeChild(a)})}},{key:"runIframes",value:function runIframes(a){var b=document.querySelectorAll("iframe."+a);b.forEach(function(a){a.src=a.getAttribute("data-src")})}},{key:"runImg",value:function runImg(a){var b=document.querySelectorAll("img."+a);b.forEach(function(a){a.src=a.getAttribute("data-src")})}},{key:"runEmbed",value:function runEmbed(a){var b=document.querySelectorAll("embed."+a);b.forEach(function(a){a.src=a.getAttribute("data-src")})}},{key:"rubObject",value:function rubObject(a){var b=document.querySelectorAll("object."+a);b.forEach(function(a){a.data=a.getAttribute("data-src")})}},{key:"noneCategoriesAnswered",value:function noneCategoriesAnswered(){var a=!0;try{return Object.entries(ccm.categoryCookies).forEach(function(b){var c=b[0];if(b=b[1],null===ccm.config.cookieCategories[c].defaultConsent&&""!==b.value)throw a=!1,"BreakException"}),a}catch(b){if("BreakException"===b)return a;CcmLog.error(b)}}},{key:"allCategoriesAnswered",value:function allCategoriesAnswered(){var a=!0;try{return Object.entries(ccm.categoryCookies).forEach(function(b){var c=b[0];if(b=b[1],ccm.config.cookieCategories[c].required&&""===b.value)throw a=!1,"BreakException"}),a}catch(b){if("BreakException"===b)return a;CcmLog.error(b)}}},{key:"massUpdateOptionalCategories",value:function massUpdateOptionalCategories(a){return Object.entries(ccm.config.cookieCategories).forEach(function(b){if(null==b[1].defaultConsent){var c=b[0];ccm.categoryCookies[c].value=a,ccm.categoryCookies[c].store()}}),!0}},{key:"giveConsent",value:function giveConsent(){if(ccm.allCategoriesAnswered()){var a=new Date;return ccm.hasAnswered()?ccm.dispatchEvent("CCM_reconsent_stored"):ccm.dispatchEvent("CCM_consent_stored"),CcmLog.debug(a),ccm.consentCookie.value=a.toString(),CcmLog.debug(a),ccm.consentCookie.store(),!0}return!1}},{key:"dispatchEvent",value:function dispatchEvent(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{var c;"function"==typeof window.CustomEvent?b?c=new CustomEvent(a,{detail:b}):c=new Event(a):b?(c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!1,!0,b)):(c=document.createEvent("HTMLEvents"),c.initEvent(a,!1,!0)),window.dispatchEvent(c)}catch(a){CcmLog.error(a)}}}]),a}();ccm=new CcmCore,CcmLog.debug("CCM config",ccm.config),ccm.preprocess();