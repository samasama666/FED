!function(){var e,u,o,t,p,m,v,n,i,h,f,y,w,k,a,r,b,d,I,s,q,c,R,V,M,j,W,z,_,U,P,l,T,x,X,g,S,C,E,A,H="_sotmpid",F="_sotmsid",L=!1;function Q(){return u.innerWidth||document.documentElement.clientWidth||i().clientWidth||document.documentElement.offsetWidth||i().offsetWidth}function Y(){return u.innerHeight||document.documentElement.clientHeight||i().clientHeight||document.documentElement.offsetHeight||i().offsetHeight}function B(e){return document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+e+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")||null}function G(e,t,n,i,o){e=e+"="+t+"; path=/; expires="+new Date(i+1e3*n).toUTCString()+"; max-age="+n+"; secure=true; SameSite=Strict;",o&&(e+="; domain="+o),document.cookie=e}function J(e){try{document.cookie=e+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT; secure=true; SameSite=Strict;"}catch(e){t.error(e)}}function O(e){var t=j();return"0:"+(e?W.toString(36)+":"+t:t)}function K(e,t){var n,i={};switch(e.toLowerCase()){case"pageview":n="/t",i=t?{ch:t.channel,bid:t.brandId,rid:t.relationId,n:t.pageType}:{};break;case"linkclick":case"loyaltyclick":n="/c",i=t?{htcid:t.headerTestChosenId,htid:t.headerTestId,bid:t.brandId,lh:t.linkHeight,lp:t.linkPath,lps:t.linkPosition,lcp:t.linkSourcePath,lw:t.linkWidth,lx1:t.linkX1,lx2:t.linkX2,ly1:t.linkY1,ly2:t.linkY2,lxp:t.linkXPath,rid:t.relationId}:{};break;case"impressions":n="/i",i=t?{bid:t.brandId,impressions:t.impressions}:{};break;case"readingtime":n="/r",i=t?{ar:t.ar,at:t.at,bid:t.brandId,rid:t.relationId,wc:t.wc,sp:t.sp,n:t.pageType}:{};break;case"datalayer":n="/d",i=t?{bid:t.brandId,rid:t.relationId,au:t.author,at:t.articleType,aa:t.articleAccess,se:t.section,le:t.length,re:t.region,uri:t.uri,ti:t.title,ta:t.tags,ts:t.timestamp,vid:t.videoId,va:t.videoAuthor,vt:t.videoTitle,vpd:t.videoPublicationDate,ha:t.hash,hv:t.hasVideo,do:t.documentId,ch:t.channel,n:t.pageType}:{};break;case"videoplay":n="/v",i=t?{bid:t.brandId,vid:t.videoId,vt:t.title,rid:t.relationId,ac:"play",se:t.section,ta:t.tags,ch:t.channel,uri:t.uri,vd:t.duration,iu:t.imageUrl,va:t.authors,vpd:t.pubDate}:{}}return{endpoint:n,mapping:i}}function N(){this.queue=[]}function D(){y=O(!1),A.pageViewId=y,E=0,m("Starting page view",y)}e="undefined"!=typeof window?window:this,o=(u=e).navigator,t=u.console,p=function(){},m=function(){},v=function(){},n=function(){},u.hasOwnProperty("tentacles")&&u.tentacles.hasOwnProperty("noCookies")&&u.tentacles.noCookies&&(p("No cookies mode enabled."),L=!0),i=function(){return document.body||document.getElementsByTagName("body").item(0)},p("Initializing Tentacles ingestion module"),T=u.screen.availWidth,x=u.screen.availHeight,z=[0,10,20,5,15,16,1,11,21,6,7,17,2,12,22,23,8,18,3,13,14,24,9,19,4],_=[1,32898,32906,2147516416,32907,2147483649,2147516545,32777,138,136,2147516425,2147483658,2147516555,139,32905,32771,32770,128,32778,2147483658,2147516545,32896],U=[0,1,30,28,27,4,12,6,23,20,3,10,11,25,7,9,13,15,21,8,18,2,29,24,14],P=function(e,t){return e<<t|e>>>32-t},a=Math,r=u.crypto||u.msCrypto,b=void 0!==r&&void 0!==r.getRandomValues,d=b?function(e){e=new Uint8Array(e);return r.getRandomValues(e),e}:function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=a.floor(256*a.random());return t},I=function(e){for(var t=d(e),n="",i=0;i<t.length;++i)n+=String.fromCharCode(t[i]);return n},s=["application/pdf","video/quicktime","video/x-msvideo","audio/x-pn-realaudio-plugin","audio/mpeg3","application/googletalk","application/x-mplayer2","application/x-director","application/x-shockwave-flash","application/x-java-vm","application/x-googlegears","application/x-silverlight"],q=function(){var e=o.mimeTypes;if(p(o.mimeTypes),e)for(var t="plugins:",n=0,i=s.length;n<i;++n)t+=s[n]in e?"1":"0";else t="";return t},c=["ShockwaveFlash.ShockwaveFlash.1","AcroPDF.PDF","AgControl.AgControl","QuickTime.QuickTime"],R=function(){if("ActiveXObject"in u)for(var t="activex:",e=0,n=c.length;e<n;++e){var i=c[e];try{var o=new ActiveXObject(i);t+="1","getVersions"in o?t+="("+o.getVersions()+")":"getVariable"in o&&(t+="("+o.getVariable("$version")+")")}catch(e){t+="0"}}else t="";return t},V=function(){var e=Q(),t=Y();return[o.userAgent||"",o.platform||"",o.language||"",o.systemLanguage||"",o.userLanguage||"",T?T.toString(36):"",x?x.toString(36):"",e?e.toString(36):"",t?e.toString(36):"",q(),R()]},M=function(){var e=[(new Date).getTime().toString(36),u.location.href||"",I(32)],t=(b||e.push.apply(e,V()),e.join("")),n=[];for(r=0;r<25;r+=1)n[r]=0;if(t.length%16==15)t+="老";else{for(t+="";t.length%16!=15;)t+="\0";t+="耀"}for(var i=0;i<t.length;i+=16){for(r=0;r<16;r+=2)n[r/2]^=t.charCodeAt(i+r)+65536*t.charCodeAt(i+r+1);for(var o=0;o<22;o+=1){for(var a=[],r=0;r<5;r+=1)a[r]=n[r]^n[r+5]^n[r+10]^n[r+15]^n[r+20];var d=[];for(r=0;r<5;r+=1)d[r]=a[(r+4)%5]^P(a[(r+1)%5],1);var s=[];for(r=0;r<25;r+=1)s[z[r]]=P(n[r]^d[r%5],U[r]);for(r=0;r<5;r+=1)for(var c=0;c<25;c+=5)n[c+r]=s[c+r]^~s[c+(r+1)%5]&s[c+(r+2)%5];n[0]^=_[o]}}var l=[];for(r=0;r<8;++r){var g=n[r];l.push(255&g,g>>>8,g>>>16,g>>>24)}return l},j=function(){for(var e=M(),t="",n=0,i=e.length;n<i;++n)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxzy0123456789~_".charAt(63&e[n]);return b||(t+="!"),t},W=(new Date).getTime(),N.prototype.enqueue=function(e){var t=this.queue;p("Queueing item for processing; "+t.length+" currently pending.",e),t.push(e),1===t.length&&(p("No pending items; processing immediately.",e),this.processNextItem())},N.prototype.processNextItem=function(){var e=this.queue[0];switch(typeof e){case"string":this.deliverFirstPendingEvent(e);break;case"function":this.invokeFirstPendingCallback(e);break;default:n("Dropping unknown type of item in beacon queue.",e),this.onFirstPendingItemCompleted()}},N.prototype.deliverFirstPendingEvent=function(e){var t=this;p("Delivering pending event.",e);function n(){o||(o=!0,clearTimeout(a),i.apply(this,arguments))}var i,o,a,r=e.split("&").reduce(function(e,t,n,i){t=t.split("=");return e[decodeURIComponent(t[0])]=decodeURIComponent(t[1]),e},{}),d=(o=!(i=function(){t.onFirstPendingItemCompleted()}),a=setTimeout(function(){o||(o=!0,p("Timeout waiting for event callback; invoking anyway.",this,arguments),i.apply(this,arguments))},1e3),new XMLHttpRequest);d.onload=n,d.onerror=n;r="https://ingestion.smartocto.com"+K(r.t).endpoint+"?"+e;d.open("get",r,!0),d.send()},N.prototype.invokeFirstPendingCallback=function(e){e(),this.onFirstPendingItemCompleted()},N.prototype.onFirstPendingItemCompleted=function(){p("Marking pending item as complete.");var e=this.queue,e=(e.shift(),e.length);0<e?(p("Processing next item; remaining count:",e),this.processNextItem()):p("All pending items have been delivered.")},X=new N,f=L?(C=u.hasOwnProperty("tentacles")&&u.tentacles.hasOwnProperty("partyId")?u.tentacles.partyId:void 0,l=u.hasOwnProperty("tentacles")&&u.tentacles.hasOwnProperty("sessionId")?u.tentacles.sessionId:void 0,h=C||(p("No window.tentacles.partyId; generating identifier."),O(!0)),l||(p("No window.tentacles.sessionId; generating identifier."),O(!0))):(C=B(H),l=B(F),h=(w=!C)?(p("No partyId; generating identifier."),O(!0)):C,(k=!l)?(p("No sessionId; generating identifier."),O(!0)):l),m("Tentacles ingestion party/session identifiers",h,f),E=0,A={partyId:h,sessionId:f,pageViewId:y,isNewPartyId:w,isFirstInSession:k,active:!1,signal:function(e,t){var n,i,o;if(y||D(),e){n=E++,n=y+n.toString(16),void 0===t?m("Signalling event: "+e,n):m("Signalling event with params: "+e,n,t);var a,r,d=document.referrer,s=(new Date).getTime(),c={p:h,s:f,v:y,e:n,c:s,f:k?"t":"f",l:u.location.href,r:d||void 0,i:T,j:x,k:u.devicePixelRatio,w:Q(),h:Y(),t:e},d=K(e,t).mapping,l=(Object.assign(c,d),""),g={};for(a in c)c.hasOwnProperty(a)&&void 0!==(r=c[a])&&(i=a,r=r,o=void 0,0<l.length&&(l+="&"),void 0===(o=g[i])&&(g[i]=o=[]),o.push(r),l+=i+"="+encodeURIComponent(r));k=w=!1,L?(p("No cookies mode; not setting cookies, we will delete them on page unload."),J(H),J(F)):(f&&(p("Setting session cookie.",f),G(F,f,1800,s,"")),h&&(p("Setting party cookie.",h),G(H,h,63072e3,s,""))),X.enqueue(l)}else v("Ignoring event with no type."),n=null;return n},apiToken:u.hasOwnProperty("tentacles")&&u.tentacles.hasOwnProperty("apiToken")?u.tentacles.apiToken:null},"object"==typeof u.ingestion&&u.ingestion.hasOwnProperty("partyId")?v("Ingestion module already initialized; existing module left intact."):(("function"!=typeof u.define||!u.define.amd)&&void 0!==u.module&&u.module.exports?u.module.exports=A:u.ingestion=A,p("Module initialized.",A),void 0!==document.hidden?(g="hidden",S="visibilitychange"):void 0!==document.mozHidden?(g="mozHidden",S="mozvisibilitychange"):void 0!==document.msHidden?(g="msHidden",S="msvisibilitychange"):void 0!==document.webkitHidden?(g="webkitHidden",S="webkitvisibilitychange"):v("Could not detect property for document visibility."),u.document[g]?u.document.addEventListener&&u.document.removeEventListener?(p("Page currently hidden; deferring start of page view."),u.document.addEventListener(S,function e(){null===y&&!1===u.document[g]&&(p("Page became visible; starting deferred page view."),D()),null!==y&&u.document.removeEventListener(S,e)})):(v("Page currently hidden, but don't know how to defer start of page view; starting page view immediately."),D()):(p("Page already visible; starting page view immediately."),D()),"onpageshow"in u&&"onpagehide"in u&&u.addEventListener&&u.removeEventListener?(p("Detected Page Transition Event API; will trigger additional page-views during navigation."),u.addEventListener("pagehide",function e(){u.removeEventListener("pagehide",e),u.addEventListener("pageshow",function(){p("Returning to page that is still loaded; starting a new page-view."),D()})})):(C=u.history)&&(C.navigationMode,1)&&(m("Changing navigation mode from "+C.navigationMode+" to 'compatible'."),C.navigationMode="compatible"))}("undefined"==typeof t&&(t={}));