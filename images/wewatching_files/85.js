!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2afd6025-901f-4ef5-a063-adb9845ce165",e._sentryDebugIdIdentifier="sentry-dbid-2afd6025-901f-4ef5-a063-adb9845ce165")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{30248:function(e,t){(function(e){"use strict";function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach(function(t){var r,n;r=t,n=i[t],(r=h(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,i=l(e);return r=t?Reflect.construct(i,arguments,l(this).constructor):i.apply(this,arguments),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function d(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return p(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function h(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var f=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function m(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[],a=Array.isArray(t=e)?t.map(function(e){return e&&e.hasOwnProperty("url")?e.url:e}):t;for(var o in!r.ERRORCODE||i.isCustomCode||/^[0-9]{3}$/.test(r.ERRORCODE)||(r.ERRORCODE=900),r.CACHEBUSTING=k(Math.round(1e8*Math.random())),r.TIMESTAMP=(new Date).toISOString(),r.RANDOM=r.random=r.CACHEBUSTING,r)r[o]=encodeURIComponent(r[o]).replace(/[!'()*]/g,function(e){return"%".concat(e.charCodeAt(0).toString(16))});for(var s in a){var l=a[s];"string"==typeof l&&n.push(function(e,t){var r=(e=g(e,t)).match(/[^[\]]+(?=])/g);if(!r)return e;var i=r.filter(function(e){return f.indexOf(e)>-1});return 0===i.length?e:g(e,i=i.reduce(function(e,t){return e[t]=-1,e},{}))}(l,r))}return n}function g(e,t){var r=e;for(var i in t){var n=t[i];r=r.replace(RegExp("(?:\\[|%%)(".concat(i,")(?:\\]|%%)"),"g"),n)}return r}function y(e){return/^(https?:\/\/|\/\/)/.test(e)}function T(e,t){for(var r=0;r<t.length;r++)if(function(e,t){if(e&&t){var r=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);return r.length===i.length&&e.id===t.id&&e.url===t.url}return!1}(t[r],e))return!0;return!1}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.toString().padStart(t,"0")}var A={track:function(e,t,r){m(e,t,r).forEach(function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)})},resolveURLTemplates:m,filterValidUrlTemplates:function(e){return Array.isArray(e)?e.filter(function(e){return y(e.hasOwnProperty("url")?e.url:e)}):y(e)},containsTemplateObject:T,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce(function(t,r){return t.concat(Array.isArray(r)?e(r):r)},[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Array.isArray(e)?e:[],i=Array.isArray(t)?t:[];return r.concat(i).reduce(function(e,t){return T(t,e)||e.push(t),e},[])},isValidTimeValue:function(e){return Number.isFinite(e)&&e>=-2},addLeadingZeros:k};function b(e){return -1!==["true","TRUE","True","1"].indexOf(e)}function R(e){if(null==e)return -1;if(A.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return -1;var r=t[2].split("."),i=parseInt(r[0]);2===r.length&&(i+=parseFloat("0.".concat(r[1])));var n=parseInt(60*t[1]),a=parseInt(60*t[0]*60);return isNaN(a)||isNaN(n)||isNaN(i)||n>3600||i>60?-1:a+n+i}var E={childByName:function(e,t){var r=e.childNodes;for(var i in r){var n=r[i];if(n.nodeName===t)return n}},childrenByName:function(e,t){var r=[],i=e.childNodes;for(var n in i){var a=i[n];a.nodeName===t&&r.push(a)}return r},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf("//")){var r=location.protocol;return"".concat(r).concat(e)}if(-1===e.indexOf("://")){var i=t.slice(0,t.lastIndexOf("/"));return"".concat(i,"/").concat(e)}return e},parseBoolean:b,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,r){var i=t.getAttribute(e);i&&r.setAttribute(e,i)},parseAttributes:function(e){for(var t=e.attributes,r={},i=0;i<t.length;i++)r[t[i].nodeName]=t[i].nodeValue;return r},parseDuration:R,splitVAST:function(e){var t=[],r=null;return e.forEach(function(i,n){if(i.sequence&&(i.sequence=parseInt(i.sequence,10)),i.sequence>1){var a=e[n-1];if(a&&a.sequence===i.sequence-1)return void(r&&r.push(i));delete i.sequence}r=[i],t.push(r)}),t},assignAttributes:function(e,t){if(e)for(var r in e){var i=e[r];if(i.nodeName&&i.nodeValue&&t.hasOwnProperty(i.nodeName)){var n=i.nodeValue;"boolean"==typeof t[i.nodeName]&&(n=b(n)),t[i.nodeName]=n}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(d(e.viewableImpression),d(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var r,i=(t.creatives||[]).filter(function(e){return e&&"companion"===e.type}),n=i.reduce(function(e,t){return(t.variations||[]).forEach(function(t){(t.companionClickTrackingURLTemplates||[]).forEach(function(t){A.containsTemplateObject(t,e)||e.push(t)})}),e},[]);e.creatives=i.concat(e.creatives);var a=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,o=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;if(e.creatives.forEach(function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var r in t.trackingEvents[e.type]){var i=t.trackingEvents[e.type][r];Array.isArray(e.trackingEvents[r])||(e.trackingEvents[r]=[]),e.trackingEvents[r]=e.trackingEvents[r].concat(i)}"linear"!==e.type||(a&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),o&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),t.videoClickThroughURLTemplate&&(null===e.videoClickThroughURLTemplate||void 0===e.videoClickThroughURLTemplate)&&(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),"companion"===e.type&&n.length&&(e.variations||[]).forEach(function(e){e.companionClickTrackingURLTemplates=A.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,n)})}),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories)),null!==(r=t.creatives)&&void 0!==r&&r.length){var s=t.creatives.filter(function(e){var t;return(null===(t=e.icons)||void 0===t?void 0:t.length)&&!e.mediaFiles.length});s.length&&(e.creatives=e.creatives.concat(s))}}};function N(e){var t=[];return e.forEach(function(e){var r=function e(t){if("#comment"===t.nodeName)return null;var r={name:null,value:null,attributes:{},children:[]},i=t.attributes,n=t.childNodes;if(r.name=t.nodeName,t.attributes){for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];o.nodeName&&o.nodeValue&&(r.attributes[o.nodeName]=o.nodeValue)}}for(var s in n)if(n.hasOwnProperty(s)){var l=e(n[s]);l&&r.children.push(l)}if(0===r.children.length||1===r.children.length&&["#cdata-section","#text"].indexOf(r.children[0].name)>=0){var c=E.parseNodeText(t);""!==c&&(r.value=c),r.children=[]}return null===r.value&&0===Object.keys(r.attributes).length&&0===r.children.length?null:r}(e);r&&t.push(r)}),t}var L={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function w(e,t){var r=e.name,i=e.parentName,n=e.attributes,a=e.subElements,o=e.oneOfResources,s="Element '".concat(r,"'");t("VAST-warning",{message:s+=n?" missing required attribute(s) '".concat(n.join(", "),"' "):a?" missing required sub element(s) '".concat(a.join(", "),"' "):o?" must provide one of the following '".concat(o.join(", "),"' "):" is empty",parentElement:i,specVersion:4.1})}var U={verifyRequiredValues:function e(t,r,i){if(t&&t.nodeName){if("InLine"===t.nodeName&&(i=!0),function(e,t){if(L[e.nodeName]&&L[e.nodeName].attributes){var r=L[e.nodeName].attributes.filter(function(t){return!e.getAttribute(t)});r.length>0&&w({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:r},t)}}(t,r),t.children&&0!==t.children.length){(function(e,t,r){var i=L[e.nodeName],n=!r&&"Wrapper"!==e.nodeName;if(i&&!n){if(i.subElements){var a=i.subElements.filter(function(t){return!E.childByName(e,t)});a.length>0&&w({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:a},t)}r&&i.oneOfinLineResources&&(i.oneOfinLineResources.some(function(t){return E.childByName(e,t)})||w({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:i.oneOfinLineResources},t))}})(t,r,i);for(var n=0;n<t.children.length;n++)e(t.children[n],r,i)}else 0===E.parseNodeText(t).length&&w({name:t.nodeName,parentName:t.parentNode.nodeName},r)}}};function C(e,t){var r=[];t&&U.verifyRequiredValues(e,t);var i,n=e.childNodes,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(E.parseAttributes(e));for(var o in n){var s=n[o];switch(s.nodeName){case"Error":a.errorURLTemplates.push(E.parseNodeText(s));break;case"Impression":a.impressionURLTemplates.push({id:s.getAttribute("id")||null,url:E.parseNodeText(s)});break;case"Creatives":a.creatives=function(e){var t=[];return e.forEach(function(e){var r,i={id:e.getAttribute("id")||null,adId:e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null,sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},n=[];E.childrenByName(e,"UniversalAdId").forEach(function(e){var t={idRegistry:e.getAttribute("idRegistry")||"unknown",value:E.parseNodeText(e)};n.push(t)});var a=E.childByName(e,"CreativeExtensions");for(var o in a&&(r=N(E.childrenByName(a,"CreativeExtension"))),e.childNodes){var s=e.childNodes[o],l=void 0;switch(s.nodeName){case"Linear":l=function(e,t){var r,i=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);i.duration=E.parseDuration(E.parseNodeText(E.childByName(e,"Duration")));var n=e.getAttribute("skipoffset");if(null==n)i.skipDelay=null;else if("%"===n.charAt(n.length-1)&&-1!==i.duration){var a=parseInt(n,10);i.skipDelay=i.duration*(a/100)}else i.skipDelay=E.parseDuration(n);var o=E.childByName(e,"VideoClicks");if(o){var s=E.childByName(o,"ClickThrough");i.videoClickThroughURLTemplate=s?{id:s.getAttribute("id")||null,url:E.parseNodeText(s)}:null,E.childrenByName(o,"ClickTracking").forEach(function(e){i.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:E.parseNodeText(e)})}),E.childrenByName(o,"CustomClick").forEach(function(e){i.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:E.parseNodeText(e)})})}var l=E.childByName(e,"AdParameters");l&&(i.adParameters={value:E.parseNodeText(l),xmlEncoded:l.getAttribute("xmlEncoded")||null}),E.childrenByName(e,"TrackingEvents").forEach(function(e){E.childrenByName(e,"Tracking").forEach(function(e){var t=e.getAttribute("event"),n=E.parseNodeText(e);if(t&&n){if("progress"===t){if(!(r=e.getAttribute("offset")))return;t="%"===r.charAt(r.length-1)?"progress-".concat(r):"progress-".concat(Math.round(E.parseDuration(r)))}Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(n)}})}),E.childrenByName(e,"MediaFiles").forEach(function(e){E.childrenByName(e,"MediaFile").forEach(function(e){var t,r,n;i.mediaFiles.push(((t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null}).id=e.getAttribute("id"),t.fileURL=E.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0),(r=e.getAttribute("scalable"))&&"string"==typeof r&&(t.scalable=E.parseBoolean(r)),(n=e.getAttribute("maintainAspectRatio"))&&"string"==typeof n&&(t.maintainAspectRatio=E.parseBoolean(n)),t))});var t=E.childByName(e,"InteractiveCreativeFile");t&&(i.interactiveCreativeFile=((n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:E.parseBoolean(e.variableDuration),fileURL:null}}(E.parseAttributes(t))).fileURL=E.parseNodeText(t),n));var r=E.childByName(e,"ClosedCaptionFiles");r&&E.childrenByName(r,"ClosedCaptionFile").forEach(function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(E.parseAttributes(e));t.fileURL=E.parseNodeText(e),i.closedCaptionFiles.push(t)});var n,a,o,s=E.childByName(e,"Mezzanine"),l=(a={},o=!1,["delivery","type","width","height"].forEach(function(e){s&&s.getAttribute(e)?a[e]=s.getAttribute(e):o=!0}),o?null:a);if(l){var c={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};c.id=s.getAttribute("id"),c.fileURL=E.parseNodeText(s),c.delivery=l.delivery,c.codec=s.getAttribute("codec"),c.type=l.type,c.width=parseInt(l.width,10),c.height=parseInt(l.height,10),c.fileSize=parseInt(s.getAttribute("fileSize"),10),c.mediaType=s.getAttribute("mediaType")||"2D",i.mezzanine=c}});var c=E.childByName(e,"Icons");return c&&E.childrenByName(c,"Icon").forEach(function(e){i.icons.push(function(e){var t,r,i={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null,iconClickFallbackImages:[]};i.program=e.getAttribute("program"),i.height=parseInt(e.getAttribute("height")||0),i.width=parseInt(e.getAttribute("width")||0),i.xPosition=-1!==["left","right"].indexOf(t=e.getAttribute("xPosition"))?t:parseInt(t||0),i.yPosition=-1!==["top","bottom"].indexOf(r=e.getAttribute("yPosition"))?r:parseInt(r||0),i.apiFramework=e.getAttribute("apiFramework"),i.pxratio=e.getAttribute("pxratio")||"1",i.offset=E.parseDuration(e.getAttribute("offset")),i.duration=E.parseDuration(e.getAttribute("duration")),E.childrenByName(e,"HTMLResource").forEach(function(e){i.type=e.getAttribute("creativeType")||"text/html",i.htmlResource=E.parseNodeText(e)}),E.childrenByName(e,"IFrameResource").forEach(function(e){i.type=e.getAttribute("creativeType")||0,i.iframeResource=E.parseNodeText(e)}),E.childrenByName(e,"StaticResource").forEach(function(e){i.type=e.getAttribute("creativeType")||0,i.staticResource=E.parseNodeText(e)});var n=E.childByName(e,"IconClicks");if(n){i.iconClickThroughURLTemplate=E.parseNodeText(E.childByName(n,"IconClickThrough")),E.childrenByName(n,"IconClickTracking").forEach(function(e){i.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:E.parseNodeText(e)})});var a=E.childByName(n,"IconClickFallbackImages");a&&E.childrenByName(a,"IconClickFallbackImage").forEach(function(e){i.iconClickFallbackImages.push({url:E.parseNodeText(e)||null,width:e.getAttribute("width")||null,height:e.getAttribute("height")||null})})}return i.iconViewTrackingURLTemplate=E.parseNodeText(E.childByName(e,"IconViewTracking")),i}(e))}),i}(s,i);break;case"NonLinearAds":l=function(e,t){var r=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return E.childrenByName(e,"TrackingEvents").forEach(function(e){var t,i;E.childrenByName(e,"Tracking").forEach(function(e){t=e.getAttribute("event"),i=E.parseNodeText(e),t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))})}),E.childrenByName(e,"NonLinear").forEach(function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=E.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=E.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=E.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),E.childrenByName(e,"HTMLResource").forEach(function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=E.parseNodeText(e)}),E.childrenByName(e,"IFrameResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=E.parseNodeText(e)}),E.childrenByName(e,"StaticResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=E.parseNodeText(e)});var i=E.childByName(e,"AdParameters");i&&(t.adParameters={value:E.parseNodeText(i),xmlEncoded:i.getAttribute("xmlEncoded")||null}),t.nonlinearClickThroughURLTemplate=E.parseNodeText(E.childByName(e,"NonLinearClickThrough")),E.childrenByName(e,"NonLinearClickTracking").forEach(function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:E.parseNodeText(e)})}),r.variations.push(t)}),r}(s,i);break;case"CompanionAds":l=function(e,t){var r=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"companion",required:null,variations:[]}}(t);return r.required=e.getAttribute("required")||null,r.variations=E.childrenByName(e,"Companion").map(function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotId:e.adSlotId||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(E.parseAttributes(e));t.htmlResources=E.childrenByName(e,"HTMLResource").reduce(function(e,t){var r=E.parseNodeText(t);return r?e.concat(r):e},[]),t.iframeResources=E.childrenByName(e,"IFrameResource").reduce(function(e,t){var r=E.parseNodeText(t);return r?e.concat(r):e},[]),t.staticResources=E.childrenByName(e,"StaticResource").reduce(function(e,t){var r=E.parseNodeText(t);return r?e.concat({url:r,creativeType:t.getAttribute("creativeType")||null}):e},[]),t.altText=E.parseNodeText(E.childByName(e,"AltText"))||null;var r=E.childByName(e,"TrackingEvents");r&&E.childrenByName(r,"Tracking").forEach(function(e){var r=e.getAttribute("event"),i=E.parseNodeText(e);r&&i&&(Array.isArray(t.trackingEvents[r])||(t.trackingEvents[r]=[]),t.trackingEvents[r].push(i))}),t.companionClickTrackingURLTemplates=E.childrenByName(e,"CompanionClickTracking").map(function(e){return{id:e.getAttribute("id")||null,url:E.parseNodeText(e)}}),t.companionClickThroughURLTemplate=E.parseNodeText(E.childByName(e,"CompanionClickThrough"))||null;var i=E.childByName(e,"AdParameters");return i&&(t.adParameters={value:E.parseNodeText(i),xmlEncoded:i.getAttribute("xmlEncoded")||null}),t}),r}(s,i)}l&&(n&&(l.universalAdIds=n),r&&(l.creativeExtensions=r),t.push(l))}}),t}(E.childrenByName(s,"Creative"));break;case"Extensions":var l=E.childrenByName(s,"Extension");a.extensions=N(l),a.adVerifications.length||(r=function(e){var t=null,r=[];return e.some(function(e){return t=E.childByName(e,"AdVerifications")}),t&&(r=I(E.childrenByName(t,"Verification"))),r}(l));break;case"AdVerifications":a.adVerifications=I(E.childrenByName(s,"Verification"));break;case"AdSystem":a.system={value:E.parseNodeText(s),version:s.getAttribute("version")||null};break;case"AdTitle":a.title=E.parseNodeText(s);break;case"AdServingId":a.adServingId=E.parseNodeText(s);break;case"Category":a.categories.push({authority:s.getAttribute("authority")||null,value:E.parseNodeText(s)});break;case"Expires":a.expires=parseInt(E.parseNodeText(s),10);break;case"ViewableImpression":a.viewableImpression.push((i=void 0,i=function(e,t){var r=E.parseNodeText(t);return r&&e.push(r),e},{id:s.getAttribute("id")||null,viewable:E.childrenByName(s,"Viewable").reduce(i,[]),notViewable:E.childrenByName(s,"NotViewable").reduce(i,[]),viewUndetermined:E.childrenByName(s,"ViewUndetermined").reduce(i,[])}));break;case"Description":a.description=E.parseNodeText(s);break;case"Advertiser":a.advertiser={id:s.getAttribute("id")||null,value:E.parseNodeText(s)};break;case"Pricing":a.pricing={value:E.parseNodeText(s),model:s.getAttribute("model")||null,currency:s.getAttribute("currency")||null};break;case"Survey":a.survey={value:E.parseNodeText(s),type:s.getAttribute("type")||null};break;case"BlockedAdCategories":a.blockedAdCategories.push({authority:s.getAttribute("authority")||null,value:E.parseNodeText(s)})}}return r.length&&(a.adVerifications=a.adVerifications.concat(r)),a}function I(e){var t=[];return e.forEach(function(e){var r={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},i=e.childNodes;for(var n in E.assignAttributes(e.attributes,r),i){var a=i[n];switch(a.nodeName){case"JavaScriptResource":case"ExecutableResource":r.resource=E.parseNodeText(a),E.assignAttributes(a.attributes,r);break;case"VerificationParameters":r.parameters=E.parseNodeText(a)}}var o=E.childByName(e,"TrackingEvents");o&&E.childrenByName(o,"Tracking").forEach(function(e){var t=e.getAttribute("event"),i=E.parseNodeText(e);t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))}),t.push(r)}),t}var x=function(){function e(){n(this,e),this._handlers=[]}return o(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw TypeError("The handler argument must be of type Function. Received type ".concat(i(t)));if(!e)throw TypeError("The event argument must be of type String. Received type ".concat(i(e)));return this._handlers.push({event:e,handler:t}),this}},{key:"once",value:function(e,t){return this.on(e,function(e,t,r){var i={fired:!1,wrapFn:void 0};function n(){i.fired||(e.off(t,i.wrapFn),i.fired=!0,r.bind(e).apply(void 0,arguments))}return i.wrapFn=n,n}(this,e,t))}},{key:"off",value:function(e,t){return this._handlers=this._handlers.filter(function(r){return r.event!==e||r.handler!==t}),this}},{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=!1;return this._handlers.forEach(function(t){"*"===t.event&&(n=!0,t.handler.apply(t,[e].concat(r))),t.event===e&&(n=!0,t.handler.apply(t,r))}),n}},{key:"removeAllListeners",value:function(e){return e?this._handlers=this._handlers.filter(function(t){return t.event!==e}):this._handlers=[],this}},{key:"listenerCount",value:function(e){return this._handlers.filter(function(t){return t.event===e}).length}},{key:"listeners",value:function(e){return this._handlers.reduce(function(t,r){return r.event===e&&t.push(r.handler),t},[])}},{key:"eventNames",value:function(){return this._handlers.map(function(e){return e.event})}}]),e}(),O={get:function(e,t,r){r(Error("Please bundle the library for node to use the node urlHandler"))}};function S(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return null}}function D(e,t,r){var i=r?408:e.status;t(Error(r?"XHRURLHandler: Request timed out after ".concat(e.timeout," ms (").concat(i,")"):"XHRURLHandler: ".concat(e.statusText," (").concat(i,")")),null,{statusCode:i})}var V={get:function(e,t,r){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return r(Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var i=S();i.open("GET",e),i.timeout=t.timeout||12e4,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType("text/xml"),i.onload=function(){200===i.status?r(null,i.responseXML,{byteLength:i.response.length,statusCode:i.status}):D(i,r,!1)},i.onerror=function(){return D(i,r,!1)},i.onabort=function(){return D(i,r,!1)},i.ontimeout=function(){return D(i,r,!0)},i.send()}catch(e){r(Error("XHRURLHandler: Unexpected error"))}},supported:function(){return!!S()}},P={get:function(e,t,r){return r||("function"==typeof t&&(r=t),t={}),"undefined"==typeof window||null===window?O.get(e,t,r):V.supported()?V.get(e,t,r):r(Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}},B=0,F=0,M=function(e,t){!e||!t||e<=0||t<=0||(F=(F*B+8*e/t)/++B)},j={ERRORCODE:900,extensions:[]},W=function(e){s(r,e);var t=u(r);function r(){var e;return n(this,r),(e=t.call(this)).remainingAds=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return o(r,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var r=arguments.length,i=Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];this.emit("VAST-error",Object.assign.apply(Object,[{},j,t].concat(i))),A.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"getEstimatedBitrate",value:function(){return F}},{key:"fetchVAST",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise(function(a,o){t.URLTemplateFilters.forEach(function(t){e=t(e)});var s=Date.now();t.emit("VAST-resolving",{url:e,previousUrl:i,wrapperDepth:r,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:n}),t.urlHandler.get(e,t.fetchingOptions,function(n,l){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=Math.round(Date.now()-s),d=Object.assign({url:e,previousUrl:i,wrapperDepth:r,error:n,duration:u},c);t.emit("VAST-resolved",d),M(c.byteLength,u),n?o(n):a(l)})})}},{key:"initParsingStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||12e4,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||P,this.vastVersion=null,M(e.byteLength,e.requestDuration)}},{key:"getRemainingAds",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(Error("No more ads are available for the given VAST"));var r=e?A.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.resolveAds(r,{wrapperDepth:0,url:this.rootURL}).then(function(e){return t.buildVASTResponse(e)})}},{key:"getAndParseVAST",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),this.URLTemplateFilters.forEach(function(t){e=t(e)}),this.rootURL=e,this.fetchVAST(e).then(function(i){return r.previousUrl=e,r.isRootVAST=!0,r.url=e,t.parse(i,r).then(function(e){return t.buildVASTResponse(e)})})}},{key:"parseVAST",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),r.isRootVAST=!0,this.parse(e,r).then(function(e){return t.buildVASTResponse(e)})}},{key:"buildVASTResponse",value:function(e){var t,r={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(r),r}},{key:"parseVastXml",value:function(e,t){var r=t.isRootVAST,i=void 0!==r&&r,n=t.url,a=void 0===n?null:n,o=t.wrapperDepth,s=void 0===o?0:o,l=t.allowMultipleAds,c=t.followAdditionalWrappers;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:a,wrapperDepth:s}),Error("Invalid VAST XMLDocument");var u=[],d=e.documentElement.childNodes,p=e.documentElement.getAttribute("version");for(var h in i&&p&&(this.vastVersion=p),d){var v=d[h];if("Error"===v.nodeName){var f=E.parseNodeText(v);i?this.rootErrorURLTemplates.push(f):this.errorURLTemplates.push(f)}else if("Ad"===v.nodeName){if(this.vastVersion&&3>parseFloat(this.vastVersion))l=!0;else if(!1===l&&u.length>1)break;var m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.allowMultipleAds,n=r.followAdditionalWrappers,a=e.childNodes;for(var o in a){var s=a[o];if(-1!==["Wrapper","InLine"].indexOf(s.nodeName)&&("Wrapper"!==s.nodeName||!1!==n)){if(E.copyNodeAttribute("id",e,s),E.copyNodeAttribute("sequence",e,s),E.copyNodeAttribute("adType",e,s),"Wrapper"===s.nodeName)return{ad:function(e,t){var r=C(e,t),i=e.getAttribute("followAdditionalWrappers"),n=e.getAttribute("allowMultipleAds"),a=e.getAttribute("fallbackOnNoAd");r.followAdditionalWrappers=!i||E.parseBoolean(i),r.allowMultipleAds=!!n&&E.parseBoolean(n),r.fallbackOnNoAd=a?E.parseBoolean(a):null;var o=E.childByName(e,"VASTAdTagURI");if(o?r.nextWrapperURL=E.parseNodeText(o):(o=E.childByName(e,"VASTAdTagURL"))&&(r.nextWrapperURL=E.parseNodeText(E.childByName(o,"URL"))),r.creatives.forEach(function(e){if(-1!==["linear","nonlinear"].indexOf(e.type)){if(e.trackingEvents){r.trackingEvents||(r.trackingEvents={}),r.trackingEvents[e.type]||(r.trackingEvents[e.type]={});var t=function(t){var i=e.trackingEvents[t];Array.isArray(r.trackingEvents[e.type][t])||(r.trackingEvents[e.type][t]=[]),i.forEach(function(i){r.trackingEvents[e.type][t].push(i)})};for(var i in e.trackingEvents)t(i)}e.videoClickTrackingURLTemplates&&(Array.isArray(r.videoClickTrackingURLTemplates)||(r.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach(function(e){r.videoClickTrackingURLTemplates.push(e)})),e.videoClickThroughURLTemplate&&(r.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(r.videoCustomClickURLTemplates)||(r.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach(function(e){r.videoCustomClickURLTemplates.push(e)}))}}),r.nextWrapperURL)return r}(s,t),type:"WRAPPER"};if("InLine"===s.nodeName)return{ad:function(e,t){return!1===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowMultipleAds&&e.getAttribute("sequence")?null:C(e,t)}(s,t,{allowMultipleAds:i}),type:"INLINE"}}}}(v,this.emit.bind(this),{allowMultipleAds:l,followAdditionalWrappers:c});m.ad?(u.push(m.ad),this.emit("VAST-ad-parsed",{type:m.type,url:a,wrapperDepth:s,adIndex:u.length-1,vastVersion:p})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return u}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.url,i=void 0===r?null:r,n=t.resolveAll,a=t.wrapperSequence,o=void 0===a?null:a,s=t.previousUrl,l=t.wrapperDepth,c=void 0===l?0:l,u=t.isRootVAST,d=void 0!==u&&u,p=t.followAdditionalWrappers,h=t.allowMultipleAds,v=[];this.vastVersion&&3>parseFloat(this.vastVersion)&&d&&(h=!0);try{v=this.parseVastXml(e,{isRootVAST:d,url:i,wrapperDepth:c,allowMultipleAds:h,followAdditionalWrappers:p})}catch(e){return Promise.reject(e)}return 1===v.length&&null!=o&&(v[0].sequence=o),!1===(void 0===n||n)&&(this.remainingAds=E.splitVAST(v),v=this.remainingAds.shift()),this.resolveAds(v,{wrapperDepth:c,previousUrl:void 0===s?null:s,url:i})}},{key:"resolveAds",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,i=r.wrapperDepth,n=r.previousUrl,a=r.url,o=[];return n=a,t.forEach(function(t){var r=e.resolveWrappers(t,i,n);o.push(r)}),Promise.all(o).then(function(t){var r=A.flatten(t);if(!r&&e.remainingAds.length>0){var o=e.remainingAds.shift();return e.resolveAds(o,{wrapperDepth:i,previousUrl:n,url:a})}return r})}},{key:"resolveWrappers",value:function(e,t,r){var i=this;return new Promise(function(n){if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,n(e);if(t>=i.maxWrapperDepth)return e.errorCode=302,delete e.nextWrapperURL,n(e);e.nextWrapperURL=E.resolveVastAdTagURI(e.nextWrapperURL,r),i.URLTemplateFilters.forEach(function(t){e.nextWrapperURL=t(e.nextWrapperURL)});var a,o=null!==(a=i.parsingOptions.allowMultipleAds)&&void 0!==a?a:e.allowMultipleAds,s=e.sequence;i.fetchVAST(e.nextWrapperURL,t,r,e).then(function(a){return i.parse(a,{url:e.nextWrapperURL,previousUrl:r,wrapperSequence:s,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:o}).then(function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],n(e);t.forEach(function(t){t&&E.mergeWrapperAdData(t,e)}),n(t)})}).catch(function(t){e.errorCode=301,e.errorMessage=t.message,n(e)})})}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var r=e.ads[t];(r.errorCode||0===r.creatives.length)&&(this.trackVastError(r.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:r.errorCode||303},{ERRORMESSAGE:r.errorMessage||""},{extensions:r.extensions},{system:r.system}),e.ads.splice(t,1))}}}]),r}(x),_=null,q={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},H=function(){function e(){n(this,e),this.storage=this.initStorage()}return o(e,[{key:"initStorage",value:function(){if(_)return _;try{_="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){_=null}return _&&!this.isStorageDisabled(_)||(_=q).clear(),_}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}(),G=function(){function e(t,r,i){n(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=r||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new W,this.storage=i||new H,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return o(e,[{key:"getParser",value:function(){return this.vastParser}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}},{key:"hasRemainingAds",value:function(){return this.vastParser.remainingAds.length>0}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Date.now();return(r=Object.assign({},this.defaultOptions,r)).hasOwnProperty("resolveAll")||(r.resolveAll=!1),this.totalCallsTimeout<i?(this.totalCalls=1,this.totalCallsTimeout=i+36e5):this.totalCalls++,new Promise(function(n,a){if(t.cappingFreeLunch>=t.totalCalls)return a(Error("VAST call canceled – FreeLunch capping not reached yet ".concat(t.totalCalls,"/").concat(t.cappingFreeLunch)));var o=i-t.lastSuccessfulAd;if(o<0)t.lastSuccessfulAd=0;else if(o<t.cappingMinimumTimeInterval)return a(Error("VAST call canceled – (".concat(t.cappingMinimumTimeInterval,")ms minimum interval reached")));t.vastParser.getAndParseVAST(e,r).then(function(e){return n(e)}).catch(function(e){return a(e)})})}}]),e}(),z=function(e){s(a,e);var t=u(a);function a(e,r,i){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(var c in n(this,a),(o=t.call(this)).ad=r,o.creative=i,o.variation=s,o.muted=l,o.impressed=!1,o.skippable=!1,o.trackingEvents={},o.lastPercentage=0,o._alreadyTriggeredQuartiles={},o.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],o.creative.trackingEvents){var u=o.creative.trackingEvents[c];o.trackingEvents[c]=u.slice(0)}return"linear"!==o.creative.type?o._initVariationTracking():o._initLinearTracking(),e&&o.on("start",function(){e.lastSuccessfulAd=Date.now()}),o}return o(a,[{key:"_initLinearTracking",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:"_initVariationTracking",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):"companionAd"===this.variation.adType&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:"setDuration",value:function(e){A.isValidTimeValue(e)&&(this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100})}},{key:"setProgress",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(A.isValidTimeValue(e)&&"object"===i(r)){var n=this.skipDelay||-1;if(-1===n||this.skippable||(n>e?this.emit("skip-countdown",n-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.assetDuration>0){var a=Math.round(e/this.assetDuration*100),o=[];if(e>0){o.push("start");for(var s=this.lastPercentage;s<a;s++)o.push("progress-".concat(s+1,"%"));for(var l in o.push("progress-".concat(Math.round(e))),this.quartiles)this.isQuartileReached(l,this.quartiles[l],e)&&(o.push(l),this._alreadyTriggeredQuartiles[l]=!0);this.lastPercentage=a}o.forEach(function(e){t.track(e,{macros:r,once:!0})}),e<this.progress&&this.track("rewind",{macros:r})}this.progress=e}}},{key:"isQuartileReached",value:function(e,t,r){var i=!1;return t<=r&&!this._alreadyTriggeredQuartiles[e]&&(i=!0),i}},{key:"setMuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e)}},{key:"setPaused",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e)}},{key:"setFullscreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e)}},{key:"setExpand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"===i(t)&&(this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e)}},{key:"setSkipDelay",value:function(e){A.isValidTimeValue(e)&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&(this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e})))}},{key:"trackViewableImpression",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(t)&&this.ad.viewableImpression.forEach(function(r){e.trackURLs(r.viewable,t)})}},{key:"trackNotViewableImpression",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(t)&&this.ad.viewableImpression.forEach(function(r){e.trackURLs(r.notViewable,t)})}},{key:"trackUndeterminedImpression",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(t)&&this.ad.viewableImpression.forEach(function(r){e.trackURLs(r.viewUndetermined,t)})}},{key:"error",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"object"===i(e)&&"boolean"==typeof t&&this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:"errorWithCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"string"==typeof e&&"boolean"==typeof t&&(this.error({ERRORCODE:e},t),console.log("The method errorWithCode is deprecated, please use vast tracker error method instead"))}},{key:"complete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("complete",{macros:e})}},{key:"notUsed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&(this.track("notUsed",{macros:e}),this.trackingEvents=[])}},{key:"otherAdInteraction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("otherAdInteraction",{macros:e})}},{key:"acceptInvitation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("acceptInvitation",{macros:e})}},{key:"adExpand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("adExpand",{macros:e})}},{key:"adCollapse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("adCollapse",{macros:e})}},{key:"minimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("minimize",{macros:e})}},{key:"verificationNotExecuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e&&"object"===i(t)){if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw Error("No adVerifications provided");if(!e)throw Error("No vendor provided, unable to find associated verificationNotExecuted");var r=this.ad.adVerifications.find(function(t){return t.vendor===e});if(!r)throw Error("No associated verification element found for vendor: ".concat(e));var n=r.trackingEvents;if(n&&n.verificationNotExecuted){var a=n.verificationNotExecuted;this.trackURLs(a,t),this.emit("verificationNotExecuted",{trackingURLTemplates:a})}}}},{key:"overlayViewDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&"object"===i(t)&&(t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t}))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track(this.linear?"closeLinear":"close",{macros:e})}},{key:"skip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("skip",{macros:e})}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"===i(e)&&this.track("loaded",{macros:e})}},{key:"click",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null===e||"string"==typeof e)&&"object"===i(t)){this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var n=this.clickThroughURLTemplate||e,a=r({},t);if(n){this.progress&&(a.ADPLAYHEAD=this.progressFormatted());var o=A.resolveURLTemplates([n],a)[0];this.emit("clickthrough",o)}}}},{key:"track",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.macros,n=void 0===r?{}:r,a=t.once;if("object"===i(n)){"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close");var o=this.trackingEvents[e],s=this.emitAlwaysEvents.indexOf(e)>-1;o?(this.emit(e,{trackingURLTemplates:o}),this.trackURLs(o,n)):s&&this.emit(e,null),void 0!==a&&a&&(delete this.trackingEvents[e],s&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}}},{key:"trackURLs",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=A.filterValidUrlTemplates(e),o=r({},i);this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(t=t.universalAdIds)&&void 0!==t&&t.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map(function(e){return e.idRegistry.concat(" ",e.value)}).join(",")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map(function(e){return e.value}).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),A.track(a,o,n)}},{key:"convertToTimecode",value:function(e){if(!A.isValidTimeValue(e))return"";var t=1e3*e;return"".concat(A.addLeadingZeros(Math.floor(t/36e5),2),":").concat(A.addLeadingZeros(Math.floor(t/6e4%60),2),":").concat(A.addLeadingZeros(Math.floor(t/1e3%60),2),".").concat(A.addLeadingZeros(Math.floor(t%1e3),3))}},{key:"progressFormatted",value:function(){return this.convertToTimecode(this.progress)}}]),a}(x);e.VASTClient=G,e.VASTParser=W,e.VASTTracker=z,e.parseDuration=R,Object.defineProperty(e,"__esModule",{value:!0})})(t)},20343:function(e,t,r){"use strict";r.d(t,{u:function(){return c}});var i=r(73076),n=r(39424),a=r(29531),o=r(41001),s=r(36096);async function l(){try{s.X&&o.kg.log("Flushing events..."),await (0,n.yl)(2e3),s.X&&o.kg.log("Done flushing events")}catch(e){s.X&&o.kg.log("Error while flushing events:\n",e)}}async function c(e){let{req:t,res:r,err:o}=e,s=r&&r.statusCode||e.statusCode;if(s&&s<500||!e.pathname)return Promise.resolve();(0,i.$e)(e=>{t&&e.setSDKProcessingMetadata({request:t}),(0,n.Tb)(o||`_error.js called with falsy error (${o})`,{mechanism:{type:"instrument",handled:!1,data:{function:"_error.getInitialProps"}}})}),function(e){let t=a.GLOBAL_OBJ[Symbol.for("@vercel/request-context")],r=t&&t.get&&t.get()?t.get():{};r&&r.waitUntil&&r.waitUntil(e)}(l())}},89899:function(e,t,r){"use strict";r.d(t,{r:function(){return a}});var i=r(22810),n=r(35938);function a(e){return new Proxy(e,{apply:async(e,t,r)=>{if((0,i.E)())return e.apply(t,r);let[a]=r,{req:o,res:s}=a,l=(0,n.PO)(e);if(!o||!s)return l.apply(t,r);{let e=(0,n.KT)(l,o,s,{dataFetcherRouteName:"/_error",requestedRouteName:a.pathname,dataFetchingMethodName:"getInitialProps"}),{data:i,baggage:c,sentryTrace:u}=await e.apply(t,r);return u&&(i._sentryTraceData=u),c&&(i._sentryBaggage=c),i}}})}}}]);